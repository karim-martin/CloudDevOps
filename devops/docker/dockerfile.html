<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Dockerfile tutorial - build custom Docker images with Dockerfile instructions.">
  <title>Dockerfile | CloudDevOps</title>
  <link rel="stylesheet" href="../../assets/css/main.css">
  <link rel="icon" type="image/svg+xml" href="../../assets/images/logo.svg">
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to main content</a>
  <header class="site-header">
    <div class="header-container">
      <a href="../../" class="logo"><img src="../../assets/images/logo.svg" alt=""><span>CloudDevOps</span></a>
      <nav class="main-nav"><a href="../../devops/" class="nav-link active">DevOps</a><a href="../../cloud/" class="nav-link">Cloud</a></nav>
      <div class="header-actions"><button class="mobile-menu-toggle" aria-label="Open menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button></div>
    </div>
  </header>

  <div class="sidebar-overlay"></div>

  <div class="page-wrapper">
    <aside class="sidebar"><nav class="sidebar-nav">
      <div class="sidebar-section"><h3 class="sidebar-section-title">Docker</h3><ul class="sidebar-links">
        <li><a href="./">Docker Overview</a></li>
        <li><a href="./concepts.html">Core Concepts</a></li>
        <li><a href="./dockerfile.html" class="active">Dockerfile</a></li>
        <li><a href="./compose.html">Docker Compose</a></li>
        <li><a href="./networking.html">Networking</a></li>
        <li><a href="./volumes.html">Volumes & Storage</a></li>
        <li><a href="./best-practices.html">Best Practices</a></li>
      </ul></div>
    </nav></aside>
    <main id="main-content" class="main-content">
      <article class="content-article">
        <nav class="breadcrumbs"><ol>
          <li><a href="../../">Home</a></li>
          <li><a href="../">DevOps</a></li>
          <li><a href="./">Docker</a></li>
          <li aria-current="page">Dockerfile</li>
        </ol></nav>

        <header class="article-header"><h1>Dockerfile</h1></header>

        <div class="article-body">
          <p>A Dockerfile is a text file with instructions to build a Docker image.</p>

          <h2 id="instructions">Dockerfile Instructions</h2>
          <div class="table-wrapper">
            <table class="cheatsheet-table">
              <thead><tr><th>Instruction</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>FROM</code></td><td>Base image</td></tr>
                <tr><td><code>WORKDIR</code></td><td>Set working directory</td></tr>
                <tr><td><code>COPY</code></td><td>Copy files from host to image</td></tr>
                <tr><td><code>ADD</code></td><td>Copy files (supports URLs, tar extraction)</td></tr>
                <tr><td><code>RUN</code></td><td>Execute command during build</td></tr>
                <tr><td><code>CMD</code></td><td>Default command when container starts</td></tr>
                <tr><td><code>ENTRYPOINT</code></td><td>Configure container as executable</td></tr>
                <tr><td><code>ENV</code></td><td>Set environment variable</td></tr>
                <tr><td><code>ARG</code></td><td>Build-time variable</td></tr>
                <tr><td><code>EXPOSE</code></td><td>Document exposed ports</td></tr>
                <tr><td><code>VOLUME</code></td><td>Create mount point</td></tr>
                <tr><td><code>USER</code></td><td>Set user for subsequent commands</td></tr>
                <tr><td><code>LABEL</code></td><td>Add metadata</td></tr>
              </tbody>
            </table>
          </div>

          <h2 id="example-node">Example: Node.js Application</h2>
          <pre><code class="language-dockerfile"># Use official Node.js image
FROM node:20-alpine

# Set working directory
WORKDIR /app

# Copy package files first (for caching)
COPY package*.json ./

# Install dependencies
RUN npm ci --only=production

# Copy application code
COPY . .

# Expose port
EXPOSE 3000

# Set non-root user
USER node

# Start application
CMD ["node", "server.js"]</code></pre>

          <h2 id="example-python">Example: Python Application</h2>
          <pre><code class="language-dockerfile">FROM python:3.11-slim

WORKDIR /app

# Install dependencies
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Copy application
COPY . .

EXPOSE 8000

CMD ["python", "app.py"]</code></pre>

          <h2 id="multi-stage">Multi-Stage Builds</h2>
          <p>Use multiple FROM statements to create smaller production images.</p>
          <pre><code class="language-dockerfile"># Build stage
FROM node:20 AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

# Production stage
FROM node:20-alpine
WORKDIR /app
COPY --from=builder /app/dist ./dist
COPY --from=builder /app/node_modules ./node_modules
EXPOSE 3000
CMD ["node", "dist/server.js"]</code></pre>

          <h2 id="cmd-vs-entrypoint">CMD vs ENTRYPOINT</h2>
          <div class="table-wrapper">
            <table class="cheatsheet-table">
              <thead><tr><th>CMD</th><th>ENTRYPOINT</th></tr></thead>
              <tbody>
                <tr><td>Default command, can be overridden</td><td>Always executed</td></tr>
                <tr><td><code>docker run image other-cmd</code> replaces CMD</td><td><code>docker run image arg</code> passes arg to ENTRYPOINT</td></tr>
              </tbody>
            </table>
          </div>

          <pre><code class="language-dockerfile"># Using both together
ENTRYPOINT ["python", "app.py"]
CMD ["--port", "8000"]

# Run with: docker run image --port 3000
# Executes: python app.py --port 3000</code></pre>

          <h2 id="build">Building Images</h2>
          <pre><code class="language-bash"># Build image
docker build -t myapp:1.0 .

# Build with different Dockerfile
docker build -f Dockerfile.prod -t myapp:prod .

# Build with build args
docker build --build-arg VERSION=1.0 -t myapp .

# Build without cache
docker build --no-cache -t myapp .</code></pre>

          <h2 id="dockerignore">.dockerignore</h2>
          <p>Exclude files from the build context:</p>
          <pre><code># .dockerignore
node_modules
npm-debug.log
.git
.gitignore
Dockerfile*
docker-compose*
.env
*.md
.vscode</code></pre>
        </div>

        <nav class="page-navigation">
          <a href="./concepts.html" class="nav-prev"><span class="nav-label">Previous</span><span class="nav-title">Core Concepts</span></a>
          <a href="./compose.html" class="nav-next"><span class="nav-label">Next</span><span class="nav-title">Docker Compose</span></a>
        </nav>
      </article>
    </main>
  </div>

  <footer class="site-footer"><div class="footer-container"><p class="copyright">CloudDevOps - Learning Journey</p></div></footer>
  <script src="../../assets/js/navigation.js"></script>
  <script src="../../assets/js/main.js"></script>
</body>
</html>
